import angr


proj = angr.Project("./bug")

#loading the required symbols
main = proj.loader.find_symbol('main').rebased_addr
passwd = proj.loader.find_symbol('passwd').rebased_addr
buf = proj.loader.find_symbol('buf').rebased_addr


init_state = proj.factory.entry_state(addr=main)
'''uname = init_state.solver.BVS('uname', 8*8)
init_state.solver.add(uname=='C'*8)
init_state.memory.store(buf,uname)'''

sm = proj.factory.simgr()
sm.explore(find=lambda s: b'Well done!' in s.posix.dumps(1))
s = simgr.found[0]

print(s.posix.dumps(0))
